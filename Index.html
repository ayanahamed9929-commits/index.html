<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System Fix - Dev by Ayan</title>
    <style>
        body { margin: 0; background-color: #000; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        #controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 10px; background: rgba(255, 255, 255, 0.1);
            padding: 10px; border-radius: 50px; backdrop-filter: blur(10px); z-index: 100;
        }
        .btn {
            width: 45px; height: 45px; border-radius: 50%; border: 1px solid white;
            cursor: pointer; background: #222; color: white; font-size: 9px;
            display: flex; align-items: center; justify-content: center; transition: 0.3s;
        }
        .btn:hover { background: #ffcc00; color: #000; transform: scale(1.1); }
        #dev-credit {
            position: absolute; top: 20px; left: 20px; color: #fff;
            background: rgba(0, 0, 0, 0.5); padding: 10px 20px; border-radius: 30px;
        }
    </style>
</head>
<body>

    <div id="dev-credit">Dev by <b>Ayan</b></div>

    <div id="controls">
        <button class="btn" onclick="focusObject('sun')">Sun</button>
        <button class="btn" onclick="focusObject('mercury')">Merc</button>
        <button class="btn" onclick="focusObject('venus')">Venus</button>
        <button class="btn" onclick="focusObject('earth')">Earth</button>
        <button class="btn" onclick="focusObject('moon')">Moon</button>
        <button class="btn" onclick="focusObject('mars')">Mars</button>
        <button class="btn" onclick="focusObject('jupiter')">Jupi</button>
        <button class="btn" onclick="resetView()">Reset</button>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 5000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const loader = new THREE.TextureLoader();
        
        // ১. Background Stars (Generated code - image lagbe na)
        const starGeometry = new THREE.BufferGeometry();
        const starVertices = [];
        for (let i = 0; i < 15000; i++) {
            starVertices.push((Math.random() - 0.5) * 3000, (Math.random() - 0.5) * 3000, (Math.random() - 0.5) * 3000);
        }
        starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
        const stars = new THREE.Points(starGeometry, new THREE.PointsMaterial({ color: 0xffffff, size: 0.8 }));
        scene.add(stars);

        const bodies = {};

        // ২. Sun
        const sun = new THREE.Mesh(new THREE.SphereGeometry(18, 64, 64), new THREE.MeshBasicMaterial({ 
            map: loader.load('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/lava/lavatile.jpg'),
            color: 0xffcc00 
        }));
        scene.add(sun);
        bodies['sun'] = sun;

        // ৩. Planet Creator with backup color if texture fails
        function createPlanet(name, size, textureUrl, distance, speed) {
            const mesh = new THREE.Mesh(
                new THREE.SphereGeometry(size, 32, 32), 
                new THREE.MeshStandardMaterial({ 
                    map: loader.load(textureUrl),
                    roughness: 0.5
                })
            );
            const pivot = new THREE.Object3D();
            scene.add(pivot);
            pivot.add(mesh);
            mesh.position.x = distance;

            // Orbit line
            const orbit = new THREE.Mesh(new THREE.RingGeometry(distance - 0.3, distance + 0.3, 128), new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.1, side: THREE.DoubleSide }));
            orbit.rotation.x = Math.PI/2;
            scene.add(orbit);

            bodies[name] = mesh;
            return { mesh, pivot, speed };
        }

        const textureBase = 'https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/planets/';
        
        const planets = [
            createPlanet('mercury', 2.8, textureBase + 'mercurymap.jpg', 40, 0.02),
            createPlanet('venus', 4.2, textureBase + 'venusmap.jpg', 65, 0.015),
            createPlanet('earth', 4.8, textureBase + 'earth_atmos_2048.jpg', 95, 0.01),
            createPlanet('mars', 3.8, textureBase + 'mars_1k_color.jpg', 125, 0.008),
            // Jupiter texture fix (Using a more reliable URL)
            createPlanet('jupiter', 10, 'https://upload.wikimedia.org/wikipedia/commons/e/e2/Jupiter.jpg', 170, 0.005)
        ];

        // Moon (Attached to Earth)
        const moon = new THREE.Mesh(new THREE.SphereGeometry(1.3, 32, 32), new THREE.MeshStandardMaterial({ map: loader.load(textureBase + 'moon_1024.jpg') }));
        bodies['earth'].add(moon);
        moon.position.x = 9;
        bodies['moon'] = moon;

        // Lighting
        const sunLight = new THREE.PointLight(0xffffff, 8000, 2000);
        scene.add(sunLight);
        scene.add(new THREE.AmbientLight(0x555555));

        camera.position.set(0, 250, 500);
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;

        let targetObject = null;
        window.focusObject = (name) => {
            targetObject = bodies[name];
            controls.minDistance = 15;
            controls.maxDistance = 60;
        };
        window.resetView = () => {
            targetObject = null;
            camera.position.set(0, 250, 500);
            controls.target.set(0, 0, 0);
            controls.maxDistance = 2000;
        };

        function animate() {
            requestAnimationFrame(animate);
            sun.rotation.y += 0.002;
            planets.forEach(p => { 
                p.pivot.rotation.y += p.speed; 
                p.mesh.rotation.y += 0.01; 
            });
            moon.rotation.y += 0.02;

            if (targetObject) {
                const targetPos = new THREE.Vector3();
                targetObject.getWorldPosition(targetPos);
                controls.target.lerp(targetPos, 0.1);
            }
            controls.update();
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
